# Falls der Spieler auf die eine Option geklickt hat, wird die Steuern-Funktion geladen
execute as @e[type=minecraft:armor_stand,tag=EtiFlugz.1Flugzeug] at @s if entity @p[distance=..28,team=TMFlugz.1Pilot,scores={PZFlugz.1Wert=1..}] run function flugzeug:v1steuern

# Von der Position des Flugzeug-Rüstungsständers wird nach einem Piloten gesucht und dieser darf nicht den Wert null besitzen, muss also den Auslöser betätigt haben. Dann erhält er im Chat alle Steuerungsoptionen des Flugzeuges.
execute at @e[type=minecraft:armor_stand,tag=EtiFlugz.1Flugzeug] as @p[distance=..28,team=TMFlugz.1Pilot] unless entity @s[scores={PZFlugz.1Wert=0}] run tellraw @s ["Flugzeug.1: ",{"text":"\nrichtung = ","bold":true,"hoverEvent":{"action":"show_text","value":{"text":"Tippe für Norden"} },"clickEvent":{"action":"run_command","value":"/trigger PZFlugz.1Wert set 1"} },{"text":"Norden","color":"gray","bold":true},{"text":"\nrichtung = ","bold":true,"hoverEvent":{"action":"show_text","value":{"text":"Tippe für Osten"} },"clickEvent":{"action":"run_command","value":"/trigger PZFlugz.1Wert set 2"} },{"text":"Osten","color":"gray","bold":true},{"text":"\nrichtung = ","bold":true,"hoverEvent":{"action":"show_text","value":{"text":"Tippe für Süden"} },"clickEvent":{"action":"run_command","value":"/trigger PZFlugz.1Wert set 3"} },{"text":"Süden","color":"gray","bold":true},{"text":"\nrichtung = ","bold":true,"hoverEvent":{"action":"show_text","value":{"text":"Tippe für Westen"} },"clickEvent":{"action":"run_command","value":"/trigger PZFlugz.1Wert set 4"} },{"text":"Westen","color":"gray","bold":true},{"text":"\nrichtung == ","bold":true},{"entity":"@e[type=minecraft:armor_stand,tag=EtiFlugz.1Richtung,sort=nearest,limit=1]","nbt":"CustomName","interpret":true},{"text":"\nneigung = ","bold":true,"hoverEvent":{"action":"show_text","value":{"text":"Tippe für Oben"} },"clickEvent":{"action":"run_command","value":"/trigger PZFlugz.1Wert set 5"} },{"text":"Oben","color":"gray","bold":true},{"text":"\nneigung = ","bold":true,"hoverEvent":{"action":"show_text","value":{"text":"Tippe für Geradeaus"} },"clickEvent":{"action":"run_command","value":"/trigger PZFlugz.1Wert set 6"} },{"text":"Geradeaus","color":"gray","bold":true},{"text":"\nneigung = ","bold":true,"hoverEvent":{"action":"show_text","value":{"text":"Tippe für Unten"} },"clickEvent":{"action":"run_command","value":"/trigger PZFlugz.1Wert set 7"} },{"text":"Unten","color":"gray","bold":true},{"text":"\nneigung == ","bold":true},{"entity":"@e[type=minecraft:armor_stand,tag=EtiFlugz.1Neigung,sort=nearest,limit=1]","nbt":"CustomName","interpret":true},{"text":"\ntempomat (","bold":true},{"text":"wahr","color":"gray","bold":true,"hoverEvent":{"action":"show_text","value":{"text":"Tippe für aktiven Tempomat"} },"clickEvent":{"action":"run_command","value":"/trigger PZFlugz.1Wert set 8"} },{"text":"!","bold":true},{"text":"falsch","color":"gray","bold":true,"hoverEvent":{"action":"show_text","value":{"text":"Tippe für inaktiven Tempomat"} },"clickEvent":{"action":"run_command","value":"/trigger PZFlugz.1Wert set 9"} },{"text":") == ","bold":true},{"entity":"@e[type=minecraft:armor_stand,tag=EtiFlugz.1Tempomat,sort=nearest,limit=1]","nbt":"CustomName","interpret":true},{"text":"\naußenansicht (","bold":true},{"text":"wahr","color":"gray","bold":true,"hoverEvent":{"action":"show_text","value":{"text":"Tippe für die Außenansicht"} },"clickEvent":{"action":"run_command","value":"/trigger PZFlugz.1Wert set 10"} },{"text":"!","bold":true},{"text":"falsch","color":"gray","bold":true,"hoverEvent":{"action":"show_text","value":{"text":"Tippe für die Innenansicht"} },"clickEvent":{"action":"run_command","value":"/trigger PZFlugz.1Wert set 11"} },{"text":") == ","bold":true},{"entity":"@e[type=minecraft:armor_stand,tag=EtiFlugz.1Aussenansicht,sort=nearest,limit=1]","nbt":"CustomName","interpret":true},{"text":"\nfahren(richtung,neigung)","color":"gray","bold":true,"hoverEvent":{"action":"show_text","value":{"text":"Flugzeug fliegen"} },"clickEvent":{"action":"run_command","value":"/trigger PZFlugz.1Wert set 12"} } ]

# Von der Position des Flugzeug-Rüstungsständers erhält der Pilot die Erlaubnis den Auslöser wieder zu betätigen und sein Wert wird wieder auf null gesetzt.
execute at @e[type=minecraft:armor_stand,tag=EtiFlugz.1Flugzeug] as @p[distance=..28,team=TMFlugz.1Pilot] unless entity @s[scores={PZFlugz.1Wert=0}] run scoreboard players enable @s PZFlugz.1Wert
execute at @e[type=minecraft:armor_stand,tag=EtiFlugz.1Flugzeug] as @p[distance=..28,team=TMFlugz.1Pilot] unless entity @s[scores={PZFlugz.1Wert=0}] run scoreboard players set @s PZFlugz.1Wert 0

# Wenn die Außenansicht aktivert wurde, so wird der Aussenansichts-Rüstungsständer von der Rotation her so teleportiert, dass er die gleiche Ausrichtung besitzt wie der Spieler. Anschließend wird von Rüstungsständer aus 20 Meter hinter ihm der Spieler teleportiert, sodass der Spieler eine dritte-Person-Ansicht für das Flugzeug erhält.
execute as @e[type=minecraft:armor_stand,tag=EtiFlugz.1Aussenansicht,name="wahr",sort=nearest,limit=1] positioned as @s rotated as @p[team=TMFlugz.1Pilot] run teleport @s ~ ~ ~ ~ ~
execute if entity @e[type=minecraft:armor_stand,tag=EtiFlugz.1Aussenansicht,name="wahr",sort=nearest,limit=1] as @p[team=TMFlugz.1Pilot] at @e[type=minecraft:armor_stand,tag=EtiFlugz.1Aussenansicht,sort=nearest,limit=1] run teleport @s ^ ^0.5 ^-20

# Wenn der Tempomat eingeschaltet wurde, so wird dem dazugehörigen Rüstungsständer ein Wert jeden Tick erhöht und beim Wert vier wieder auf null gesetzt. Wenn der Wert genau eins ist, wird dem Spieler der Wert zwölf gegeben, damit das Flugzeug in die entsprechende Richtung automatisch fliegt.
scoreboard players add @e[type=minecraft:armor_stand,tag=EtiFlugz.1Tempomat,name="wahr",sort=nearest,limit=1] PZFlugz.1Wert 1
scoreboard players set @e[type=minecraft:armor_stand,tag=EtiFlugz.1Tempomat,name="wahr",scores={PZFlugz.1Wert=4..},sort=nearest,limit=1] PZFlugz.1Wert 0
execute at @e[type=minecraft:armor_stand,tag=EtiFlugz.1Tempomat,name="wahr",scores={PZFlugz.1Wert=1},sort=nearest,limit=1] run scoreboard players set @p[distance=..28,team=TMFlugz.1Pilot] PZFlugz.1Wert 12
